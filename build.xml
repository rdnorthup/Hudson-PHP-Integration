<?xml version="1.0"?>

<project name="Test Job" default="build">

	<target name="build" depends="clean, prepare, phpcs, pdepend, phpunit, code-coverage">
	</target>
	
	<target name="clean">
		<delete dir="build"/>
	</target>
	
	<target name="prepare">
		<mkdir dir="build/logs"/>
		<mkdir dir="build/docs"/>
	</target>
	
	<target name="phpdoc">
		<exec dir="." executable="phpdoc" failonerror="true">
			<arg line="-t build/docs --directory . -ti 'Test Job Docs' --parseprivate on --undocumentedelements on --output HTML:Smarty:PHP"/>
		</exec>
	</target>
	
	<target name="phpcs">
		<exec dir="." executable="phpcs" failonerror="false" output="build/logs/checkstyle.xml">
			<arg line="--report=checkstyle ."/>
		</exec>
	</target>
	
	<target name="pdepend">
		<exec dir="." executable="pdepend" failonerror="true">
			<arg line="--jdepend-xml=build/logs/jdepend.xml ."/>
		</exec>
	</target>
	
	<target name="phpunit">
		<exec dir="." executable="phpunit" failonerror="true">
			<arg line="--log-junit build/logs/junit.xml --coverage-clover build/logs/clover.xml --verbose test"/>
		</exec>
	</target>
	
	<target name="code-coverage">
		<exec dir="." executable="phpunit" failonerror="true">
			<arg line="--coverage-clover build/logs/clover.xml ."/>
		</exec>
	</target>
	
</project>

